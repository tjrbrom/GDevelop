(this["webpackJsonpgdevelop-ide"]=this["webpackJsonpgdevelop-ide"]||[]).push([[4],{113:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"create",(function(){return k}));var r=n(15),o=n.n(r),a=n(631),i=n(16),u=n(918),c=n(921),s=(n(33),n(66),n(1749)),l=n(1750),p=n(1754),d=n(1765),f=n(1775),m=n(1776),v=n.n(m),h=n(1778),g=n(448),b=n(227),w=n(915),E=n(1790),j=n(1791),x=n(902),P=n(927),O=n(1792),S=n(1985),y=n(1807),D=e.gd,k=function(e){i.b.setUpContextMenu();var t=i.b.getArguments(),n=i.b.isDev();return o.a.createElement(w.a,{authentication:e,disableCheckForUpdates:!!t["disable-update-check"],makeEventsFunctionCodeWriter:h.a,eventsFunctionsExtensionWriter:E.a,eventsFunctionsExtensionOpener:j.a,resourceFetcher:S.a},(function(e){var r=e.i18n;return o.a.createElement(x.a,{appArguments:t,storageProviders:[P.a],defaultStorageProvider:P.a},(function(e){var t=e.getStorageProviderOperations,i=e.storageProviders,m=e.initialFileMetadataToOpen,h=e.getStorageProvider;return o.a.createElement(a.a,{i18n:r,renderMainMenu:function(e){return o.a.createElement(f.a,e)},renderPreviewLauncher:function(e,t){return o.a.createElement(p.a,Object.assign({},e,{ref:t}))},renderExportDialog:function(e){return o.a.createElement(u.a,{project:e.project,onChangeSubscription:e.onChangeSubscription,onClose:e.onClose,automatedExporters:d.a,manualExporters:d.b,onlineWebExporter:d.c})},renderCreateDialog:function(e){return o.a.createElement(c.a,Object.assign({},e,{onCreateBlank:y.a,onCreateFromExampleShortHeader:y.b}))},renderGDJSDevelopmentWatcher:n?function(){return o.a.createElement(O.a,null)}:null,onCreateFromExampleShortHeader:y.b,onCreateBlank:y.a,storageProviders:i,getStorageProviderOperations:t,getStorageProvider:h,resourceSources:s.a,resourceExternalEditors:l.a,extensionsLoader:v()({gd:D,objectsEditorService:g.a,objectsRenderingService:b.a,filterExamples:!n}),initialFileMetadataToOpen:m})}))}))}}.call(this,n(8))},1749:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1),i=n(18),u=n(609),c=n(239),s=n(17),l=n.n(s),p=n(16),d=l()("electron"),f=d?d.remote.dialog:null,m=l()("path"),v=Object(i.a)(u.a.map((function(e){var t=e.kind,n=(e.displayName,e.fileExtensions),r=e.createNewResource;return{name:"local-file-opener-"+t,displayName:{id:"Choose a file"},displayTab:"import",kind:t,selectResourcesHeadless:function(){var e=Object(a.a)(o.a.mark((function e(a){var i,u,s,l,v,h,g,b,w,E,j,x;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.i18n,u=a.getLastUsedPath,s=a.setLastUsedPath,l=a.project,v=a.options,f){e.next=3;break}throw new Error("Electron dialog not supported in this environment.");case 3:return h=["openFile"],v.multiSelection&&h.push("multiSelections"),g=m.dirname(l.getProjectFile()),b=u(l,t)||g,w=d.remote.getCurrentWindow(),e.next=10,f.showOpenDialog(w,{title:i._({id:"Choose a file"}),properties:h,filters:[{name:i._({id:"Supported files"}),extensions:n}],defaultPath:b});case 10:if(E=e.sent,(j=E.filePaths)&&j.length){e.next=14;break}return e.abrupt("return",[]);case 14:if(x=m.parse(j[0]).dir,s(l,t,x),!j.filter((function(e){return!Object(c.f)(l,e)})).length){e.next=23;break}if(!p.b.showConfirmDialog(i._({id:"This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?"}))){e.next=23;break}return e.next=22,Object(c.b)(l,j);case 22:j=e.sent;case 23:return e.abrupt("return",j.map((function(e){var t=r(),n=m.dirname(l.getProjectFile());return t.setFile(m.relative(n,e)),t.setName(m.relative(n,e)),t})));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),renderComponent:function(){return null}}})));t.a=v},1750:function(e,t,n){"use strict";var r=n(1751),o=n(1752),a=n(1753),i=n(27),u=[{name:"piskel-app",displayName:"Edit with Piskel",kind:"image",edit:function(e){return Object(i.g)("piskel"),Object(r.a)(e)}},{name:"Jfxr",displayName:"Create/Edit a Sound effect with Jfxr (*.wav)",kind:"audio",edit:function(e){return Object(i.g)("jfxr"),Object(o.a)(e)}},{name:"Yarn",displayName:"Create/Edit a Dialogue Tree with Yarn (*.json)",kind:"json",edit:function(e){return Object(i.g)("yarn"),Object(a.a)(e)}}];t.a=u},1751:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var r=n(119),o=n(17),a=n.n(o),i=n(239),u=a()("electron"),c=a()("path"),s=u?u.ipcRenderer:null,l=e.gd,p=function(e){var t=e.project,n=(e.resourcesLoader,e.resourceNames),o=e.singleFrame,a=e.onChangesSaved,p=e.extraOptions;if(u&&s){var d=n.map((function(e,n){return{resourcePath:Object(i.d)(t,e),resourceName:e,originalIndex:n}})),f=c.dirname(t.getProjectFile()),m=Object(r.a)(Object(r.a)({},p),{},{resources:d,singleFrame:o,projectPath:f});s.removeAllListeners("piskel-changes-saved"),s.on("piskel-changes-saved",(function(e,n,r,o){var u=o.data?{pskl:o}:null,s=t.getResourcesManager();n.forEach((function(e){e.name=c.relative(f,e.path),Object(i.c)(t,new l.ImageResource,e.name)})),n[0].metadata=u,n[0].newAnimationName=r,o.singleFrame?(u&&s.getResource(c.relative(f,n[0].path)).setMetadata(JSON.stringify(u)),a(n)):a(n)})),s.send("piskel-open-then-load-animation",m)}}}).call(this,n(8))},1752:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(17),o=n.n(r),a=n(239),i=o()("electron"),u=o()("path"),c=i?i.ipcRenderer:null,s=e.gd,l=function(e){var t=e.project,n=(e.resourcesLoader,e.resourceNames),r=e.onChangesSaved,o=e.extraOptions;if(i&&c){var l=u.dirname(t.getProjectFile()),p={resourcePath:Object(a.d)(t,n[0]),externalEditorData:o.externalEditorData,projectPath:l};c.removeAllListeners("jfxr-changes-saved"),c.on("jfxr-changes-saved",(function(e,n,o){var i=u.relative(l,n);Object(a.c)(t,new s.AudioResource,i);var c={jfxr:o};t.getResourcesManager().getResource(i).setMetadata(JSON.stringify(c)),r([{metadata:c,name:i}])})),c.send("jfxr-create-wav",p)}}}).call(this,n(8))},1753:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(17),o=n.n(r),a=n(239),i=o()("electron"),u=o()("path"),c=i?i.ipcRenderer:null,s=e.gd,l=function(e){var t=e.project,n=(e.resourcesLoader,e.resourceNames),r=e.onChangesSaved,o=e.extraOptions;if(i&&c){var l=u.dirname(t.getProjectFile()),p={resourcePath:Object(a.d)(t,n[0]),externalEditorData:o.externalEditorData,projectPath:l};c.removeAllListeners("yarn-changes-saved"),c.on("yarn-changes-saved",(function(e,n){var o=u.relative(l,n);Object(a.c)(t,new s.JsonResource,o),r([{name:o}])})),c.send("yarn-create-json",p)}}}).call(this,n(8))},1754:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return S}));var r=n(119),o=n(3),a=n(4),i=n(6),u=n(5),c=n(115),s=n(15),l=n(249),p=n(17),d=n.n(p),f=n(883),m=n(229),v=n(1755),h=n(176),g=n.n(h),b=n(541),w=n(1764),E=d()("electron"),j=d()("path"),x=E?E.ipcRenderer:null,P=E?E.remote.BrowserWindow:null,O=e.gd,S=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return(e=t.call.apply(t,[this].concat(i))).canDoNetworkPreview=function(){return!0},e.canDoHotReload=function(){return!0},e.state={networkPreviewDialogOpen:!1,networkPreviewHost:null,networkPreviewPort:null,networkPreviewError:null,previewGamePath:null,devToolsOpen:!1,previewBrowserWindowConfig:null,hotReloadsCount:0,hideMenuBar:!0,alwaysOnTop:!0},e._networkPreviewSubscriptionChecker=null,e._hotReloadSubscriptionChecker=null,e._openPreviewBrowserWindow=function(){if(P&&e.state.previewBrowserWindowConfig&&e.state.previewGamePath){var t=Object(r.a)(Object(r.a)({},e.state.previewBrowserWindowConfig),{},{parent:e.state.alwaysOnTop?P.getFocusedWindow():null}),n=new P(t);n.loadURL("file://".concat(e.state.previewGamePath,"/index.html")),n.setMenuBarVisibility(e.state.hideMenuBar),n.webContents.on("devtools-opened",(function(){e.setState({devToolsOpen:!0})})),n.webContents.on("devtools-closed",(function(){e.setState({devToolsOpen:!1})})),e.state.devToolsOpen&&n.openDevTools()}},e._openPreviewWindow=function(t,n,r){e.setState({previewBrowserWindowConfig:{width:t.getGameResolutionWidth(),height:t.getGameResolutionHeight(),useContentSize:!0,title:"Preview of ".concat(t.getName()),backgroundColor:"#000000",webPreferences:{nodeIntegration:!0}},previewGamePath:n,hideMenuBar:!r.getIsMenuBarHiddenInPreview(),alwaysOnTop:r.getIsAlwaysOnTopInPreview()},(function(){if(r.networkPreview){if(!x)return;x.removeAllListeners("serve-folder-done"),x.removeAllListeners("local-network-ips"),x.on("serve-folder-done",(function(t,n,r){n?e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:null,networkPreviewHost:null,networkPreviewError:n}):e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:r.port}),setTimeout((function(){return e._checkSubscriptionForNetworkPreview()}))})),x.on("local-network-ip",(function(t,n){e.setState({networkPreviewHost:n})})),x.send("serve-folder",{root:n}),x.send("get-local-network-ip")}else e._openPreviewBrowserWindow()}))},e._prepareExporter=function(){return Object(m.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=g()(new O.AbstractFileSystemJS,l.a);return{outputDir:j.join(n.getTempDir(),"preview"),exporter:new O.Exporter(n,t)}}))},e.launchPreview=function(t){var n=t.project,r=t.layout,o=t.externalLayout;return e.getPreviewDebuggerServer().startServer().catch((function(e){console.error("Unable to start the Debugger Server for the preview:",e)})).then((function(){return e._prepareExporter()})).then((function(a){var i=a.outputDir,u=a.exporter;Object(f.a)((function(){var a=new O.PreviewExportOptions(n,i);a.setLayoutName(r.getName()),o&&a.setExternalLayoutName(o.getName());var c=Object(w.a)();c&&a.useWebsocketDebuggerClientWithServerAddress(c.address,""+c.port);var s=e.props.getIncludeFileHashs();for(var l in s){var p=s[l];a.setIncludeFileHash(l,p)}var d=e.getPreviewDebuggerServer().getExistingDebuggerIds(),f=t.hotReload&&!!d.length;a.setProjectDataOnlyExport(f&&t.projectDataOnlyExport),a.setFullLoadingScreen(t.fullLoadingScreen),u.exportProjectForPixiPreview(a),a.delete(),u.delete(),f?(d.forEach((function(t){e.getPreviewDebuggerServer().sendMessage(t,{command:"hotReload"})})),e.state.hotReloadsCount%16===0&&e._hotReloadSubscriptionChecker&&e._hotReloadSubscriptionChecker.checkHasSubscription(),e.setState((function(e){return{hotReloadsCount:e.hotReloadsCount+1}}))):e._openPreviewWindow(n,i,t)}),(function(e){return console.info("Preview took ".concat(e,"ms"))}))}))},e._checkSubscriptionForNetworkPreview=function(){return!e._networkPreviewSubscriptionChecker||e._networkPreviewSubscriptionChecker.checkHasSubscription()},e}return Object(a.a)(n,[{key:"getPreviewDebuggerServer",value:function(){return w.b}},{key:"render",value:function(){var e=this,t=this.state,n=t.networkPreviewDialogOpen,r=t.networkPreviewHost,o=t.networkPreviewPort,a=t.networkPreviewError;return s.createElement(s.Fragment,null,s.createElement(b.a,{ref:function(t){return e._networkPreviewSubscriptionChecker=t},onChangeSubscription:function(){e.setState({networkPreviewDialogOpen:!1}),e.props.onChangeSubscription&&e.props.onChangeSubscription()},id:"Preview over wifi",title:s.createElement(c.Trans,{id:"Preview over wifi"}),mode:"try"}),s.createElement(b.a,{ref:function(t){return e._hotReloadSubscriptionChecker=t},onChangeSubscription:function(){e.props.onChangeSubscription&&e.props.onChangeSubscription()},id:"Hot reloading",title:s.createElement(c.Trans,{id:"Live preview (apply changes to the running preview)"}),mode:"try"}),s.createElement(v.a,{open:n,url:r&&o?"".concat(r,":").concat(o):null,error:a,onClose:function(){return e.setState({networkPreviewDialogOpen:!1})},onExport:this.props.onExport,onRunPreviewLocally:this._openPreviewBrowserWindow}))}}]),n}(s.Component)}).call(this,n(8))},1755:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(3),o=n(4),a=n(6),i=n(5),u=n(115),c=n(15),s=n(128),l=n(124),p=n(135),d=n(125),f=n(117),m=n(162),v=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.url,n=e.open,r=e.error,o=e.onExport,a=e.onClose,i=e.onRunPreviewLocally;return n?c.createElement(s.a,{actions:[c.createElement(l.a,{key:"close",label:c.createElement(u.Trans,{id:"Close"}),primary:!0,onClick:a})],secondaryActions:[o&&c.createElement(l.a,{key:"export",label:c.createElement(u.Trans,{id:"Export game"}),onClick:o}),c.createElement(l.a,{key:"run-preview-locally",label:c.createElement(u.Trans,{id:"Run on this computer"}),onClick:i})],cannotBeDismissed:!0,open:n,onRequestClose:a},r&&c.createElement(f.b,null,c.createElement(d.a,null,c.createElement(u.Trans,{id:"Unable to start the server for the preview! Make sure that you are authorized to run servers on this computer. Otherwise, use classic preview to test your game."}))),!r&&!t&&c.createElement(m.a,null),!r&&t&&c.createElement("div",null,c.createElement(f.b,null,c.createElement(d.a,null,c.createElement(u.Trans,{id:"Your preview is ready! On your mobile or tablet, open your browser and enter in the address bar:"}))),c.createElement(p.b,{value:t,fullWidth:!0}),c.createElement(f.b,null,c.createElement(d.a,null,c.createElement(u.Trans,{id:"Please note that your device should be connected on the same network as this computer."}))))):null}}]),n}(c.Component)},1764:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var r=n(17),o=n.n(r)()("electron"),a=o?o.ipcRenderer:null,i="stopped",u=null,c=[],s=[],l={startServer:function(){if(!a)return Promise.reject();if("started"===i)return Promise.resolve();var e=new Promise((function(e,t){var n=!1;i="stopped",u=null,a&&(a.removeAllListeners("debugger-send-message-done"),a.removeAllListeners("debugger-error-received"),a.removeAllListeners("debugger-connection-closed"),a.removeAllListeners("debugger-connection-opened"),a.removeAllListeners("debugger-start-server-done"),a.removeAllListeners("debugger-message-received")),a.on("debugger-error-received",(function(e,r){n||(t(r),n=!0),c.forEach((function(e){return(0,e.onErrorReceived)(r)}))})),a.on("debugger-connection-closed",(function(e,t){var n=t.id,r=s.indexOf(n);-1!==r&&s.splice(r,1),c.forEach((function(e){return(0,e.onConnectionClosed)({id:n,debuggerIds:s})}))})),a.on("debugger-connection-opened",(function(e,t){var n=t.id;s.push(n),c.forEach((function(e){return(0,e.onConnectionOpened)({id:n,debuggerIds:s})}))})),a.on("debugger-start-server-done",(function(t,r){var o=r.address;console.info("Local preview debugger started"),i="started",u=o,n||(e(),n=!0),c.forEach((function(e){return(0,e.onServerStateChanged)()}))})),a.on("debugger-message-received",(function(e,t){var n=t.id,r=t.message;console.info("Processing message received for debugger");try{var o=JSON.parse(r);c.forEach((function(e){return(0,e.onHandleParsedMessage)({id:n,parsedMessage:o})}))}catch(a){console.warn("Error while parsing message received from debugger client:",a)}})),a.send("debugger-start-server")})),t=new Promise((function(e,t){setTimeout((function(){t(new Error("Debugger server not started or errored after 5s - aborting."))}),5e3)}));return Promise.race([e,t])},sendMessage:function(e,t){a&&("stopped"!==i?a.send("debugger-send-message",{id:e,message:JSON.stringify(t)}):console.error("Cannot send message when debugger server is stopped."))},getServerState:function(){return i},getExistingDebuggerIds:function(){return s},registerCallbacks:function(e){return c.push(e),function(){var t=c.indexOf(e);-1!==t&&c.splice(t,1)}}},p=function(){return u}},1765:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return E}));var r=n(119),o=n(1766),a=n(1767),i=n(1768),u=n(1769),c=n(1771),s=n(1772),l=n(1773),p=n(454),d=n(466),f=n(464),m=n(457),v=n(458),h=n(459),g=n(455),b=Object(r.a)(Object(r.a)({},d.c),{},{exportPipeline:l.a}),w=[Object(r.a)(Object(r.a)({},f.c),{},{exportPipeline:i.a}),Object(r.a)(Object(r.a)({},v.b),{},{exportPipeline:c.a}),Object(r.a)(Object(r.a)({},h.b),{},{exportPipeline:s.a}),Object(r.a)(Object(r.a)({},m.c),{},{exportPipeline:u.a})],E=[Object(r.a)(Object(r.a)({},f.c),{},{exportPipeline:i.a}),Object(r.a)(Object(r.a)({},p.c),{},{exportPipeline:o.a}),Object(r.a)(Object(r.a)({},g.c),{},{exportPipeline:a.a})]},1766:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var r=n(115),o=n(15),a=n.n(o),i=n(127),u=n(117),c=n(229),s=n(249),l=n(453),p=n(176),d=n.n(p),f=n(17),m=n.n(f),v=n(454),h=m()("electron"),g=h?h.shell:null,b=e.gd,w={name:"local-cordova",packageNameWarningType:"mobile",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var t=e.project,n=e.exportState,r=e.updateExportState;return a.a.createElement(u.a,{noMargin:!0},a.a.createElement(u.b,null,a.a.createElement(u.a,{noMargin:!0},a.a.createElement(v.b,null))),a.a.createElement(u.b,null,a.a.createElement(l.a,{type:"export",value:n.outputDir,defaultPath:t.getLastCompilationDirectory(),onChange:function(e){r((function(){return{outputDir:e}})),t.setLastCompilationDirectory(e)},fullWidth:!0})))},renderLaunchButtonLabel:function(){return a.a.createElement(r.Trans,{id:"Package"})},prepareExporter:function(e){return Object(c.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=d()(new b.AbstractFileSystemJS,s.a);return{exporter:new b.Exporter(n,t)}}))},launchExport:function(e,t){var n=t.exporter,r=new b.MapStringBoolean;return r.set("exportForCordova",!0),n.exportWholePixiProject(e.project,e.exportState.outputDir,r),r.delete(),n.delete(),Promise.resolve(null)},launchResourcesDownload:function(e,t){return Promise.resolve(null)},launchCompression:function(e,t){return Promise.resolve(null)},renderDoneFooter:function(e){var t=e.exportState,n=(e.onClose,function(){g&&g.openItem(t.outputDir)});return a.a.createElement(v.a,{renderGameButton:function(){return a.a.createElement(i.a,{key:"open",label:a.a.createElement(r.Trans,{id:"Open folder"}),primary:!0,onClick:n})}})}}}).call(this,n(8))},1767:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var r=n(115),o=n(15),a=n.n(o),i=n(127),u=n(117),c=n(229),s=n(249),l=n(453),p=n(176),d=n.n(p),f=n(17),m=n.n(f),v=n(455),h=m()("electron"),g=h?h.shell:null,b=e.gd,w={name:"local-electron",packageNameWarningType:"desktop",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var t=e.project,n=e.exportState,r=e.updateExportState;return a.a.createElement(u.a,{noMargin:!0},a.a.createElement(u.b,null,a.a.createElement(u.a,{noMargin:!0},a.a.createElement(v.b,null))),a.a.createElement(u.b,null,a.a.createElement(l.a,{type:"export",value:n.outputDir,defaultPath:t.getLastCompilationDirectory(),onChange:function(e){r((function(){return{outputDir:e}})),t.setLastCompilationDirectory(e)},fullWidth:!0})))},renderLaunchButtonLabel:function(){return a.a.createElement(r.Trans,{id:"Package"})},prepareExporter:function(e){return Object(c.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=d()(new b.AbstractFileSystemJS,s.a);return{exporter:new b.Exporter(n,t)}}))},launchExport:function(e,t){var n=t.exporter,r=new b.MapStringBoolean;return r.set("exportForElectron",!0),n.exportWholePixiProject(e.project,e.exportState.outputDir,r),r.delete(),n.delete(),Promise.resolve(null)},launchResourcesDownload:function(e,t){return Promise.resolve(null)},launchCompression:function(e,t){return Promise.resolve(null)},renderDoneFooter:function(e){var t=e.exportState,n=(e.onClose,function(){g&&g.openItem(t.outputDir)});return a.a.createElement(v.a,{renderGameButton:function(){return a.a.createElement(i.a,{key:"open",label:a.a.createElement(r.Trans,{id:"Open folder"}),primary:!0,onClick:n})}})}}}).call(this,n(8))},1768:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var r=n(115),o=n(15),a=n.n(o),i=n(127),u=n(117),c=n(229),s=n(249),l=n(453),p=n(176),d=n.n(p),f=n(17),m=n.n(f),v=n(464),h=m()("electron"),g=h?h.shell:null,b=e.gd,w={name:"local-html5",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var t=e.project,n=e.exportState,r=e.updateExportState;return a.a.createElement(u.a,{noMargin:!0},a.a.createElement(u.b,null,a.a.createElement(v.b,null)),a.a.createElement(u.b,null,a.a.createElement(l.a,{type:"export",value:n.outputDir,defaultPath:t.getLastCompilationDirectory(),onChange:function(e){r((function(){return{outputDir:e}})),t.setLastCompilationDirectory(e)},fullWidth:!0})))},renderLaunchButtonLabel:function(){return a.a.createElement(r.Trans,{id:"Export as a HTML5 game"})},prepareExporter:function(e){return Object(c.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=d()(new b.AbstractFileSystemJS,s.a);return{exporter:new b.Exporter(n,t)}}))},launchExport:function(e,t){var n=t.exporter,r=new b.MapStringBoolean;return n.exportWholePixiProject(e.project,e.exportState.outputDir,r),r.delete(),n.delete(),Promise.resolve(null)},launchResourcesDownload:function(e,t){return Promise.resolve(null)},launchCompression:function(e,t){return Promise.resolve(null)},renderDoneFooter:function(e){var t=e.exportState;e.onClose;return a.a.createElement(v.a,{renderGameButton:function(){return a.a.createElement(i.a,{fullWidth:!0,primary:!0,onClick:function(){g&&g.openItem(t.outputDir)},label:a.a.createElement(r.Trans,{id:"Open the exported game folder"})})}})}}}).call(this,n(8))},1769:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return x}));var r=n(115),o=n(15),a=n.n(o),i=n(127),u=n(117),c=n(229),s=n(249),l=n(176),p=n.n(l),d=n(17),f=n.n(d),m=n(1770),v=n(456),h=n(457),g=f()("path"),b=f()("electron"),w=b?b.remote.app:null,E=b?b.shell:null,j=e.gd,x={name:"local-facebook-instant-games",getInitialExportState:function(e){return{archiveOutputFilename:w?g.join(w.getPath("documents"),"fb-instant-game.zip"):""}},canLaunchBuild:function(e){return!!e.archiveOutputFilename},isNavigationDisabled:function(){return!1},renderHeader:function(e){e.project;var t=e.exportState,n=e.updateExportState;return a.a.createElement(u.a,{noMargin:!0},a.a.createElement(u.b,null,a.a.createElement(h.b,null)),a.a.createElement(u.b,null,a.a.createElement(m.a,{title:"Facebook Instant Games export zip file",message:"Choose where to save the exported file for Facebook Instant Games",filters:[{name:"Compressed file for Facebook Instant Games",extensions:["zip"]}],value:t.archiveOutputFilename,defaultPath:w?w.getPath("documents"):"",onChange:function(e){return n((function(){return{archiveOutputFilename:e}}))},fullWidth:!0})))},renderLaunchButtonLabel:function(){return a.a.createElement(r.Trans,{id:"Package"})},prepareExporter:function(e){return Object(c.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=p()(new j.AbstractFileSystemJS,s.a),r=new j.Exporter(n,t),o=g.join(n.getTempDir(),"FacebookInstantGamesExport");return n.mkDir(o),n.clearDir(o),{exporter:r,temporaryOutputDir:o}}))},launchExport:function(e,t){var n=t.exporter,r=t.temporaryOutputDir,o=new j.MapStringBoolean;return o.set("exportForFacebookInstantGames",!0),n.exportWholePixiProject(e.project,r,o),o.delete(),n.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:function(e,t){var n=t.temporaryOutputDir;return Promise.resolve({temporaryOutputDir:n})},launchCompression:function(e,t){var n=t.temporaryOutputDir;return Object(v.a)({path:n,outputFilename:e.exportState.archiveOutputFilename})},renderDoneFooter:function(e){var t=e.exportState,n=(e.onClose,function(){E&&g&&E.openItem(g.dirname(t.archiveOutputFilename))});return a.a.createElement(h.a,{renderGameButton:function(){return a.a.createElement(i.a,{key:"open",label:a.a.createElement(r.Trans,{id:"Open folder"}),primary:!0,onClick:n})}})}}}).call(this,n(8))},1770:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(119),o=n(3),a=n(4),i=n(6),u=n(5),c=n(115),s=n(15),l=n.n(s),p=n(135),d=n(17),f=n.n(d),m=n(127),v=f()("electron"),h=v?v.remote.dialog:null,g={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}},b=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChooseFolder=function(){if(h&&v){var t=v.remote.getCurrentWindow();return h.showSaveDialog(t,{title:e.props.title,filters:e.props.filters,message:e.props.message,defaultPath:e.props.defaultPath}).then((function(t){var n=t.filePath;e.props.onChange(n||"")}))}},e}return Object(a.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{style:Object(r.a)(Object(r.a)({},g.container),{},{width:this.props.fullWidth?"100%":void 0})},l.a.createElement(p.b,{margin:"dense",style:g.textField,type:"text",hintText:{id:"Choose a file"},value:this.props.value,onChange:function(t,n){return e.props.onChange(n)}}),l.a.createElement(m.a,{label:l.a.createElement(c.Trans,{id:"Choose"}),style:g.button,onClick:this.onChooseFolder}))}}]),n}(s.PureComponent)},1771:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));var r=n(115),o=n(15),a=n(176),i=n.n(a),u=n(224),c=n(613),s=n(229),l=n(456),p=n(17),d=n.n(p),f=n(249),m=n(458),v=d()("path"),h=d()("os"),g=e.gd,b={name:"local-online-cordova",onlineBuildType:"cordova-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["androidApk"],keystore:"new",signingDialogOpen:!1}},canLaunchBuild:function(e,t,n){return t||""===n},isNavigationDisabled:function(e,t){return!t&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return o.createElement(m.a,e)},renderLaunchButtonLabel:function(){return o.createElement(r.Trans,{id:"Packaging for Android"})},prepareExporter:function(e){return Object(s.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=i()(new g.AbstractFileSystemJS,f.a),r=new g.Exporter(n,t),o=v.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(o),n.clearDir(o),{exporter:r,temporaryOutputDir:o}}))},launchExport:function(e,t){var n=t.exporter,r=t.temporaryOutputDir,o=new g.MapStringBoolean;return o.set("exportForCordova",!0),n.exportWholePixiProject(e.project,r,o),o.delete(),n.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:function(e,t){var n=t.temporaryOutputDir;return Promise.resolve({temporaryOutputDir:n})},launchCompression:function(e,t){var n=t.temporaryOutputDir,r=h.tmpdir();return Object(l.a)({path:n,outputFilename:v.join(r,"game-archive.zip")})},launchUpload:function(e,t){return Object(u.f)().then((function(n){return Object(c.a)(t,n,e.updateStepProgress).then((function(){return n.key}))}))},launchOnlineBuild:function(e,t,n,r){var o=t.getAuthorizationHeader,a=t.firebaseUser;return a?Object(u.a)(o,a.uid,n,e.targets,e.keystore,r):Promise.reject(new Error("User is not authenticated"))}}}).call(this,n(8))},1772:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));var r=n(115),o=n(15),a=n(176),i=n.n(a),u=n(224),c=n(229),s=n(613),l=n(456),p=n(17),d=n.n(p),f=n(249),m=n(459),v=d()("path"),h=d()("os"),g=e.gd,b={name:"local-online-electron",onlineBuildType:"electron-build",limitedBuilds:!0,packageNameWarningType:"desktop",getInitialExportState:function(){return{targets:["winExe"]}},canLaunchBuild:function(e,t,n){return!!e.targets.length&&(t||""===n)},isNavigationDisabled:function(e,t){return!t&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return o.createElement(m.a,e)},renderLaunchButtonLabel:function(){return o.createElement(r.Trans,{id:"Package"})},prepareExporter:function(e){return Object(c.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=i()(new g.AbstractFileSystemJS,f.a),r=new g.Exporter(n,t),o=v.join(n.getTempDir(),"OnlineElectronExport");return n.mkDir(o),n.clearDir(o),{exporter:r,temporaryOutputDir:o}}))},launchExport:function(e,t){var n=t.exporter,r=t.temporaryOutputDir,o=new g.MapStringBoolean;return o.set("exportForElectron",!0),n.exportWholePixiProject(e.project,r,o),o.delete(),n.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:function(e,t){var n=t.temporaryOutputDir;return Promise.resolve({temporaryOutputDir:n})},launchCompression:function(e,t){var n=t.temporaryOutputDir,r=h.tmpdir();return Object(l.a)({path:n,outputFilename:v.join(r,"game-archive.zip")})},launchUpload:function(e,t){return Object(u.f)().then((function(n){return Object(s.a)(t,n,e.updateStepProgress).then((function(){return n.key}))}))},launchOnlineBuild:function(e,t,n,r){var o=t.getAuthorizationHeader,a=t.firebaseUser;return a?Object(u.b)(o,a.uid,n,e.targets,r):Promise.reject(new Error("User is not authenticated"))}}}).call(this,n(8))},1773:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));var r=n(115),o=n(15),a=n(176),i=n.n(a),u=n(224),c=n(613),s=n(229),l=n(456),p=n(17),d=n.n(p),f=n(249),m=n(466),v=d()("path"),h=d()("os"),g=e.gd,b={name:"local-online-web",onlineBuildType:"web-build",getInitialExportState:function(){return null},canLaunchBuild:function(e,t,n){return t||""===n||"done"===n},isNavigationDisabled:function(e,t){return!t&&!["","done"].includes(e)},renderHeader:function(){return o.createElement(m.a,null)},renderLaunchButtonLabel:function(){return o.createElement(r.Trans,{id:"Generate link"})},renderCustomStepsProgress:function(e,t,n){return o.createElement(m.b,{build:e,errored:t,exportStep:n})},prepareExporter:function(e){return Object(s.findGDJS)().then((function(e){var t=e.gdjsRoot;console.info("GDJS found in ",t);var n=i()(new g.AbstractFileSystemJS,f.a),r=new g.Exporter(n,t),o=v.join(n.getTempDir(),"OnlineWebExport");return n.mkDir(o),n.clearDir(o),{exporter:r,temporaryOutputDir:o}}))},launchExport:function(e,t){var n=t.exporter,r=t.temporaryOutputDir,o=new g.MapStringBoolean;return n.exportWholePixiProject(e.project,r,o),o.delete(),n.delete(),Promise.resolve({temporaryOutputDir:r})},launchResourcesDownload:function(e,t){var n=t.temporaryOutputDir;return Promise.resolve({temporaryOutputDir:n})},launchCompression:function(e,t){var n=t.temporaryOutputDir,r=h.tmpdir();return Object(l.a)({path:n,outputFilename:v.join(r,"game-archive.zip")})},launchUpload:function(e,t){return Object(u.f)().then((function(n){return Object(c.a)(t,n,e.updateStepProgress).then((function(){return n.key}))}))},launchOnlineBuild:function(e,t,n,r){var o=t.getAuthorizationHeader,a=t.firebaseUser;return a?Object(u.c)(o,a.uid,n,r):Promise.reject(new Error("User is not authenticated"))}}}).call(this,n(8))},1775:function(e,t,n){"use strict";var r=n(15),o=n(17),a=n.n(o),i=n(246),u=n(293),c=n(43),s=a()("electron"),l=s?s.ipcRenderer:null,p=function(e,t){r.useEffect((function(){if(l){var n=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.apply(void 0,r)};return l.on(e,n),function(){return l.removeListener(e,n)}}}),[e,t])};t.a=function(e){var t=e.i18n,n=e.project,o=e.recentProjectFiles,a=e.onOpenRecentFile,s=Object(u.e)(),d=t.language;return p("main-menu-open",e.onChooseProject),p("main-menu-open-recent",e.onOpenRecentFile),p("main-menu-save",e.onSaveProject),p("main-menu-save-as",e.onSaveProjectAs),p("main-menu-close",e.onCloseProject),p("main-menu-close-app",e.onCloseApp),p("main-menu-export",e.onExportProject),p("main-menu-create",e.onCreateProject),p("main-menu-open-project-manager",e.onOpenProjectManager),p("main-menu-open-home-page",e.onOpenHomePage),p("main-menu-open-debugger",e.onOpenDebugger),p("main-menu-open-about",e.onOpenAbout),p("main-menu-open-preferences",e.onOpenPreferences),p("main-menu-open-language",e.onOpenLanguage),p("main-menu-open-profile",e.onOpenProfile),p("main-menu-open-games-dashboard",e.onOpenGamesDashboard),p("update-status",e.setUpdateStatus),r.useEffect((function(){!function(e,t,n,r){var o={label:t._({id:"File"}),submenu:[{label:t._({id:"Create a New Project..."}),accelerator:Object(u.a)(r.CREATE_NEW_PROJECT),onClickSendEvent:"main-menu-create"},{type:"separator"},{label:t._({id:"Open..."}),accelerator:Object(u.a)(r.OPEN_PROJECT),onClickSendEvent:"main-menu-open"},{label:t._({id:"Open Recent"}),submenu:n.map((function(e){return{label:e.fileMetadata.fileIdentifier,onClickSendEvent:"main-menu-open-recent",eventArgs:e}}))},{type:"separator"},{label:t._({id:"Save"}),accelerator:Object(u.a)(r.SAVE_PROJECT),onClickSendEvent:"main-menu-save",enabled:!!e},{label:t._({id:"Save as..."}),accelerator:Object(u.a)(r.SAVE_PROJECT_AS),onClickSendEvent:"main-menu-save-as",enabled:!!e},{type:"separator"},{label:t._({id:"Export (web, iOS, Android)..."}),accelerator:Object(u.a)(r.EXPORT_GAME),onClickSendEvent:"main-menu-export",enabled:!!e},{type:"separator"},{label:t._({id:"Close Project"}),accelerator:Object(u.a)(r.CLOSE_PROJECT),onClickSendEvent:"main-menu-close",enabled:!!e}]};Object(c.e)()||o.submenu.push({type:"separator"},{label:t._({id:"My Profile"}),onClickSendEvent:"main-menu-open-profile"},{label:t._({id:"Games Dashboard"}),onClickSendEvent:"main-menu-open-games-dashboard"},{label:t._({id:"Preferences"}),onClickSendEvent:"main-menu-open-preferences"},{label:t._({id:"Language"}),onClickSendEvent:"main-menu-open-language"},{type:"separator"},{label:t._({id:"Exit GDevelop"}),accelerator:Object(u.a)(r.QUIT_APP),onClickSendEvent:"main-menu-close-app"});var a={label:t._({id:"Edit"}),submenu:[{label:t._({id:"Undo"}),role:"undo"},{label:t._({id:"Redo"}),role:"redo"},{type:"separator"},{label:t._({id:"Cut"}),role:"cut"},{label:t._({id:"Copy"}),role:"copy"},{label:t._({id:"Paste"}),role:"paste"},{label:t._({id:"Paste and Match Style"}),role:"pasteandmatchstyle"},{label:t._({id:"Delete"}),role:"delete"},{label:t._({id:"Select All"}),role:"selectall"}]},i={label:t._({id:"View"}),submenu:[{label:t._({id:"Show Project Manager"}),accelerator:Object(u.a)(r.OPEN_PROJECT_MANAGER),onClickSendEvent:"main-menu-open-project-manager",enabled:!!e},{label:t._({id:"Show Home"}),onClickSendEvent:"main-menu-open-home-page"},{label:t._({id:"Open Debugger"}),onClickSendEvent:"main-menu-open-debugger",enabled:!!e},{type:"separator"},{label:t._({id:"Toggle Developer Tools"}),role:"toggledevtools"},{type:"separator"},{label:t._({id:"Toggle Fullscreen"}),role:"togglefullscreen"}]},s={label:t._({id:"Window"}),role:"window",submenu:[{label:t._({id:"Minimize"}),role:"minimize"}]},p={label:t._({id:"Help"}),role:"help",submenu:[{label:t._({id:"GDevelop website"}),onClickOpenLink:"http://gdevelop-app.com"},{type:"separator"},{label:t._({id:"Community Forums"}),onClickOpenLink:"https://forum.gdevelop-app.com"},{label:t._({id:"Community Discord Chat"}),onClickOpenLink:"https://discord.gg/gdevelop"},{type:"separator"},{label:t._({id:"Contribute to GDevelop"}),onClickOpenLink:"https://gdevelop-app.com/contribute/"},{label:t._({id:"Create Extensions for GDevelop"}),onClickOpenLink:"https://github.com/4ian/GDevelop/blob/master/newIDE/README-extensions.md"},{type:"separator"},{label:t._({id:"Help to Translate GDevelop"}),onClickOpenLink:"https://crowdin.com/project/gdevelop"},{label:t._({id:"Report a wrong translation"}),onClickOpenLink:"https://github.com/4ian/GDevelop/issues/969"}]};Object(c.e)()||p.submenu.push({type:"separator"},{label:t._({id:"About GDevelop"}),onClickSendEvent:"main-menu-open-about"});var d=[o,a,i,s,p];Object(c.e)()&&(d.unshift({label:t._({id:"GDevelop 5"}),submenu:[{label:t._({id:"About GDevelop"}),onClickSendEvent:"main-menu-open-about"},{type:"separator"},{label:t._({id:"My Profile"}),onClickSendEvent:"main-menu-open-profile"},{label:t._({id:"Games Dashboard"}),onClickSendEvent:"main-menu-open-games-dashboard"},{label:t._({id:"Preferences"}),onClickSendEvent:"main-menu-open-preferences"},{label:t._({id:"Language"}),onClickSendEvent:"main-menu-open-language"},{type:"separator"},{role:"services",submenu:[]},{type:"separator"},{role:"hide"},{role:"hideothers"},{role:"unhide"},{type:"separator"},{role:"quit"}]}),a.submenu.push({type:"separator"},{label:t._({id:"Speech"}),submenu:[{role:"startspeaking"},{role:"stopspeaking"}]}),s.submenu=[{role:"minimize"},{role:"zoom"},{type:"separator"},{role:"front"}]),l&&l.send("set-main-menu",d)}(n,t,o,s)}),[t,d,n,o,s]),Object(i.b)("OPEN_RECENT_PROJECT",!0,{generateOptions:r.useCallback((function(){return o.map((function(e){return{text:e.fileMetadata.fileIdentifier,handler:function(){return a(e)}}}))}),[a,o])}),null}},1776:function(e,t,n){var r=n(899).loadExtension,o=n(17),a=n(1777).findJsExtensionModules;e.exports=function(e){var t=e.gd,n=e.objectsEditorService,i=e.objectsRenderingService,u=e.filterExamples,c=e.onFindGDJS;return{loadAllExtensions:function(e){return a({filterExamples:u,onFindGDJS:c}).then((function(a){return Promise.all(a.map((function(a){var u=null;try{u=o(a,{rethrowException:!0})}catch(c){return{extensionModulePath:a,result:{message:"Unable to import extension. Please check for any syntax error or error that would prevent it from being run.",error:!0,rawError:c}}}return u?(n&&u.registerEditorConfigurations&&u.registerEditorConfigurations(n),i&&u.registerInstanceRenderers&&u.registerInstanceRenderers(i),{extensionModulePath:a,result:r(e,t,t.JsPlatform.get(),u)}):{extensionModulePath:a,result:{error:!0,message:"Unknown error. Please check for any syntax error or error that would prevent it from being run."}}})))}),(function(e){throw console.error("Unable to find JS extensions modules"),e}))}}}},1777:function(e,t,n){var r=n(229).findGDJS,o=n(17),a=o("path"),i=o("fs");e.exports={findJsExtensionModules:function(e){var t=e.filterExamples,n=e.onFindGDJS;return(n?n():r()).then((function(e){var n=e.gdjsRoot,r=a.join(n,"Runtime","Extensions");return console.info("Searching for JS extensions (file called JsExtension.js) in ".concat(r,"...")),new Promise((function(e,n){i.readdir(r,(function(o,u){if(o)return n(o);var c=u.filter((function(e){return!t||-1===e.indexOf("Example")}));Promise.all(c.map((function(e){return t=a.join(r,e),new Promise((function(e){var n=a.join(t,"JsExtension.js");i.stat(n,(function(t,r){return e(t?null:r.isFile()?n:null)}))}));var t}))).then((function(t){e(t.filter((function(e){return!!e})))}),n)}))}))}))}}},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(17),o=n.n(r),a=n(898),i=n(426),u=n.n(i),c=o()("path"),s=o()("os"),l=o()("fs"),p=function(e){var t=e.onWriteFile,n=c.join(s.tmpdir(),"GDGeneratedEventsFunctions-"+Object(a.a)());l.mkdir(n,(function(e){e&&"EEXIST"!==e.code&&console.error("Unable to create the directory where to output events functions generated code: ",e)}));var r=function(e){return"".concat(n,"/").concat(u()(e),".js")};return{getIncludeFileFor:function(e){return r(e)},writeFunctionCode:function(e,n){return new Promise((function(o,a){var i=r(e);t({includeFile:i,content:n}),l.writeFile(i,n,(function(e){if(e)return a(e);o()}))}))},writeBehaviorCode:function(e,n){return new Promise((function(o,a){var i=r(e);t({includeFile:i,content:n}),l.writeFile(i,n,(function(e){if(e)return a(e);o()}))}))}}}},1790:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(3),o=n(175),a=n(17),i=n.n(a),u=i()("fs-extra"),c=i()("path"),s=i()("electron"),l=s?s.remote.dialog:null,p=function e(){Object(r.a)(this,e)};p.chooseEventsFunctionExtensionFile=function(){if(!l)return Promise.reject("Not supported");var e=s.remote.getCurrentWindow();return l.showSaveDialog(e,{title:"Export an extension of the project",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}],defaultPath:"Extension.json"}).then((function(e){var t=e.filePath;return t||null}))},p.writeEventsFunctionsExtension=function(e,t){return function(e,t){if(!u)return Promise.reject(new Error("Filesystem is not supported."));try{var n=JSON.stringify(e,null,2);return u.ensureDir(c.dirname(t)).then((function(){return new Promise((function(e,r){u.writeFile(t,n,(function(t){return t?r(t):e()}))}))}))}catch(r){return Promise.reject(r)}}(Object(o.b)(e),t).catch((function(e){throw console.error("Unable to write the events function extension:",e),e}))}},1791:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),o=n(17),a=n.n(o),i=a()("fs"),u=a()("electron"),c=u?u.remote.dialog:null,s=function e(){Object(r.a)(this,e)};s.chooseEventsFunctionExtensionFile=function(){if(!c)return Promise.reject("Not supported");var e=u.remote.getCurrentWindow();return c.showOpenDialog(e,{title:"Import an extension in the project",properties:["openFile"],message:"Choose an extension file to import (.json file)",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}]}).then((function(e){var t=e.filePaths;return t&&t.length?t[0]:null}))},s.readEventsFunctionExtensionFile=function(e){return function(e){return i?new Promise((function(t,n){i.readFile(e,{encoding:"utf8"},(function(r,o){if(r)return n(r);try{var a=JSON.parse(o);return t(a)}catch(i){return n(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")}(e)}},1792:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(15),o=n(17),a=n.n(o),i=n(143),u=n(253),c=n.n(u),s=a()("electron"),l=a()("child_process"),p=a()("process"),d=a()("path"),f=a()("chokidar"),m=function(){if(!s)return"";var e=p.cwd();return d.join(e,"../app")},v=function(){return l&&d?new Promise((function(e,t){var n=performance.now();l.exec('node "'.concat(d.join(m(),"scripts/import-GDJS-Runtime.js"),'" --skip-clean --skip-sources'),(function(r,o,a){if(r)return console.error("GDJS Runtime update error:\n".concat(r)),void t(r);var i=(performance.now()-n).toFixed(0);if(console.info("GDJS Runtime updated in ".concat(i,"ms:\n").concat(o)),a)return console.error("GDJS Runtime update error:\n".concat(a)),void t(new Error("Error while updating GDJS Runtime"));e()}))})):Promise.reject(new Error("Unsupported"))},h=c()((function(e,t){var n=e||"unknown-event",r=t||"unknown-file";console.info('GDJS/extensions watchers found a "'.concat(n,'" in ').concat(r,", updating GDJS Runtime...")),v().catch((function(){}))}),100),g=function(){var e=r.useContext(i.a).values.useGDJSDevelopmentWatcher;return r.useEffect((function(){if(e){var t=performance.now();if(f){var n=["../../GDJS/Runtime/**/*","../../Extensions/**/*.ts","../../Extensions/**/*.js"].map((function(e){return d.join(m(),e)}));v().catch((function(){}));var r=f.watch(n,{awaitWriteFinish:!0,ignoreInitial:!0}).on("all",h).on("error",(function(e){return console.error("Error in watcher for GDJS Runtime - manually call npm run `node import-GDJS-Runtime.js` in the newIDE/app/scripts folder if you make changes to GDJS. Error:",e)})).on("ready",(function(){var e=(performance.now()-t).toFixed(2);console.info("Watchers for GDJS Runtime/extensions installed in ".concat(e,"ms."))}));return function(){return r.close()}}console.error("Unable to use 'chokidar' from Node.js to watch changes in GDJS.")}}),[e]),null}},1807:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return w}));var r=n(0),o=n.n(r),a=n(1),i=n(20),u=n.n(i),c=n(927),s=n(17),l=n.n(s),p=n(318),d=n(27),f=n(30),m=n(904),v=e.gd,h=l()("path"),g=l()("fs-extra"),b=function(){var e=Object(a.a)(o.a.mark((function e(t){var n,r,a,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.i18n,r=t.outputPath,a=t.projectName,g&&r){e.next=3;break}return e.abrupt("return");case 3:e.prev=3,g.mkdirsSync(r),e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(3),Object(f.a)({message:n._({id:"Unable to create the game in the specified folder. Check that you have permissions to write in this folder: {outputPath} or choose another folder.",values:{outputPath:r}}),rawError:e.t0,errorId:"local-example-creation-error"}),e.abrupt("return");case 11:return i=v.ProjectHelper.createNewGDJSProject(),u=h.join(r,"game.json"),i.setProjectFile(u),Object(d.j)(""),e.abrupt("return",{project:i,storageProvider:c.a,fileMetadata:{fileIdentifier:u},projectName:a});case 16:case"end":return e.stop()}}),e,null,[[3,7]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(a.a)(o.a.mark((function e(t){var n,r,a,i,s,l,v,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.i18n,r=t.exampleShortHeader,a=t.outputPath,i=t.projectName,g&&a){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,Object(p.a)(r);case 6:return s=e.sent,g.mkdirsSync(a),e.next=10,u.a.get(s.projectFileUrl,{responseType:"text",transformResponse:[function(e){return e}]});case 10:return l=e.sent,v=l.data,b=h.join(a,"game.json"),e.next=15,Object(m.d)(v,b);case 15:return Object(d.j)(s.projectFileUrl),e.abrupt("return",{storageProvider:c.a,fileMetadata:{fileIdentifier:b},projectName:i});case 19:return e.prev=19,e.t0=e.catch(3),Object(f.a)({message:n._({id:"Unable to load the example or save it on disk."})+" "+n._({id:"Verify your internet connection or try again later."}),rawError:e.t0,errorId:"local-example-load-error"}),e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(8))},1985:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1),i=n(17),u=n.n(i),c=n(163),s=n(1793),l=n.n(s),p=function(){var e=Object(a.a)(o.a.mark((function e(t,n){var r,a,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.times,a=0,i=null;case 3:if(!(a<r)){e.next=18;break}return a++,i=null,e.prev=6,e.next=9,n();case 9:return u=e.sent,e.abrupt("return",u);case 13:e.prev=13,e.t0=e.catch(6),i=e.t0;case 16:e.next=3;break;case 18:throw i;case 19:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t,n){return e.apply(this,arguments)}}();n.d(t,"a",(function(){return b}));var d=u()("electron"),f=d?d.ipcRenderer:null,m=u()("fs-extra"),v=u()("path"),h=function(e){var t=e.getResourcesManager();return t.getAllResourceNames().toJSArray().filter((function(e){var n,r=t.getResource(e);return(n=r.getFile()).startsWith("http://")||n.startsWith("https://")||n.startsWith("ftp://")}))},g=function(){var e=Object(a.a)(o.a.mark((function e(t){var n,r,i,u,s,d,g,b,w,E,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.project,r=t.resourceNames,i=t.onProgress,m&&f){e.next=3;break}throw new Error("Unsupported");case 3:return u=n.getResourcesManager(),s=v.dirname(n.getProjectFile()),d=v.join(s,"assets"),g=new Set,b=[],w=[],E=0,j=h(n),e.abrupt("return",l.a.withConcurrency(50).for(r).process(function(){var e=Object(a.a)(o.a.mark((function e(t){var n,r,l,h,x,P;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.getResource(t),r=n.getFile(),l=v.extname(r),h=v.basename(r,l),x=Object(c.a)(h,(function(e){var t=v.join(d,e)+l;return m.existsSync(t)||g.has(t)})),P=v.join(d,x)+l,g.add(P),e.prev=7,e.next=10,p({times:2},Object(a.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.ensureDir(d);case 2:return e.next=4,f.invoke("local-file-download",r,P);case 4:n.setFile(v.relative(s,P).replace(/\\/g,"/")),w.push({resourceName:t});case 6:case"end":return e.stop()}}),e)}))));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),b.push({resourceName:t,error:e.t0});case 15:i(E++,j.length);case 16:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t){return e.apply(this,arguments)}}()).then((function(){return{fetchedResources:w,erroredResources:b}})));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b={getResourcesToFetch:h,fetchResources:g}},249:function(e,t,n){"use strict";(function(e){var r=n(17),o=n.n(r),a=n(898),i=o()("fs-extra"),u=o()("path"),c=o()("os"),s=e.gd;t.a={mkDir:function(e){try{i.mkdirsSync(e)}catch(t){return console.error("mkDir("+e+") failed: "+t),!1}return!0},dirExists:function(e){return i.existsSync(e)},clearDir:function(e){try{i.emptyDirSync(e)}catch(t){console.error("clearDir("+e+") failed: "+t)}},getTempDir:function(){return u.join(c.tmpdir(),"GDTMP-".concat(Object(a.a)()))},fileNameFrom:function(e){return this._isExternalUrl(e)?e:(e=this._translateUrl(e),u.basename(e))},dirNameFrom:function(e){return this._isExternalUrl(e)?"":(e=this._translateUrl(e),u.dirname(e).replace(/\\/g,"/"))},makeAbsolute:function(e,t){return this._isExternalUrl(e)?e:(e=this._translateUrl(e),this.isAbsolute(t)||(t=u.resolve(t)),u.resolve(t,u.normalize(e)).replace(/\\/g,"/"))},makeRelative:function(e,t){return this._isExternalUrl(e)?e:(e=this._translateUrl(e),u.relative(t,u.normalize(e)).replace(/\\/g,"/"))},isAbsolute:function(e){return!!this._isExternalUrl(e)||(0===e.length||((e=this._translateUrl(e)).length>0&&"/"===e.charAt(0)||e.length>1&&":"===e.charAt(1)))},copyFile:function(e,t){if(this._isExternalUrl(e))return!0;e=this._translateUrl(e);try{e!==t&&i.copySync(e,t)}catch(n){return console.error("copyFile("+e+", "+t+") failed: "+n),!1}return!0},writeToFile:function(e,t){try{i.outputFileSync(e,t)}catch(n){return console.error("writeToFile("+e+", ...) failed: "+n),!1}return!0},readFile:function(e){try{return i.readFileSync(e).toString()}catch(t){return console.error("readFile("+e+") failed: "+t),""}},readDir:function(e,t){t=t.toUpperCase();var n=new s.VectorString;try{i.existsSync(e)&&i.readdirSync(e).forEach((function(r){0!==t.length&&-1===r.toUpperCase().indexOf(t,r.length-t.length)||n.push_back(e+"/"+r)}))}catch(r){console.error("readDir("+e+","+t+") failed: "+r)}return n},fileExists:function(e){e=this._translateUrl(e);try{return i.statSync(e).isFile()}catch(t){return!1}},_isExternalUrl:function(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://")||e.startsWith("blob:")||e.startsWith("data:")},_translateUrl:function(e){return"g/"!==e.substr(0,2)&&"g\\"!==e.substr(0,2)||(e=e.substr(2)),e}}}).call(this,n(8))},456:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(17),o=n.n(r),a=n(552),i=o()("fs"),u=Object(a.a)("archiver"),c=function(e){var t=e.path,n=e.outputFilename,r=u();return new Promise((function(e,o){if(!i||!r)return o(new Error("Archiver unavailable"));var a=i.createWriteStream(n),u=r("zip",{zlib:{level:9}});a.on("close",(function(){console.log("Archive written at ".concat(n,", ").concat(u.pointer()," total bytes.")),e(n)})),u.on("error",(function(e){o(e)})),u.pipe(a),u.directory(t,!1),u.finalize()}))}},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17),o=n.n(r)()("electron"),a=o?o.ipcRenderer:null,i=function(e,t,n){return a?(a.removeAllListeners("local-file-upload-progress"),a.removeAllListeners("local-file-upload-done"),new Promise((function(r,o){a.on("local-file-upload-progress",(function(e,t,r){n(t,r)})),a.on("local-file-upload-done",(function(e,t){if(t)return o(t);r()})),a.send("local-file-upload",e,t)}))):Promise.reject("No support for local file upload")}},898:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17),o=n.n(r)()("os"),a=function(){try{return o.userInfo().uid}catch(e){return""}}},903:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(163),o=n(426),a=n.n(o),i=function(e,t){var n=t.pathSeparator,r=t.getArrayItemReferenceName,o=t.shouldSplit,a=t.isReferenceMagicPropertyName,i=[],u=function(e,t){return i.push({reference:e,object:t}),{[a]:!0,referenceTo:e}};return function e(t,a,i){if(null!==t&&"object"===typeof t)if(Array.isArray(t))for(var c in t){var s=a+n+"*";if(o(s)){var l=t[c],p=r(l,i),d=i+n+p;t[c]=u(d,l),e(l,s,d)}else{var f=i+n+c;e(t[c],s,f)}}else for(var m in t){var v=a+n+m,h=i+n+m;if(o(v)){var g=t[m];t[m]=u(h,g),e(g,v,h)}else e(t[m],v,h)}}(e,"",""),i},u=function(e,t){var n=t.isReferenceMagicPropertyName,r=t.getReferencePartialObject,o=t.maxUnsplitDepth;return function e(t,a){if(void 0!==o&&a>=o)return Promise.resolve();if(null!==t&&"object"===typeof t){var i=Object.keys(t);if(i)return Promise.all(i.map((function(o){var i=function(e){return!0===e[n]?e:null}(t[o]);return i?r(i.referenceTo).then((function(n){return t[o]=n,e(t[o],a+1)})):e(t[o],a+1)}))).then((function(){}))}return Promise.resolve()}(e,0)},c=function(e){return function(t){return e.has(t)}},s=function(e){var t={};return function(n,o){var i=n[e];if("string"!==typeof i)throw new Error("Property ".concat(e," is not a string"));t[o]=t[o]||{};var u=Object(r.a)(a()(i),(function(e){return!!t[o][e]}));return t[o][u]=!0,u}}},904:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return S}));var r=n(119),o=n(0),a=n.n(o),i=n(1),u=n(175),c=n(17),s=n.n(c),l=n(903),p=n(249),d=n(176),f=n.n(d),m=e.gd,v=s()("fs-extra"),h=s()("path"),g=s()("electron"),b=g?g.remote.dialog:null,w=function(e,t){var n=performance.now();return new Promise((function(r,o){v.readFile(e,{encoding:"utf8"},(function(a,i){if(a)return o(a);""===i&&o(new Error("Written file is empty, did the write fail?")),i!==t&&o(new Error("Written file is not containing the expected content, did the write fail?"));var u=performance.now()-n;console.info("Verified ".concat(e," content in ").concat(u.toFixed(),"ms.")),r()}))}))},E=function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}throw new Error("Filesystem is not supported.");case 2:if(""!==t){e.next=4;break}throw new Error("The content to save on disk is empty. Aborting.");case 4:return e.next=6,v.ensureDir(h.dirname(n));case 6:return e.next=8,v.writeFile(n,t);case 8:return e.next=10,w(n,t);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify(t,null,2),e.next=3,E(r,n);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(e,t,n){var r=Object(u.b)(e);if(e.isFolderProject()){var o=Object(l.b)(r,{pathSeparator:"/",getArrayItemReferenceName:Object(l.a)("name"),shouldSplit:Object(l.c)(new Set(["/layouts/*","/externalLayouts/*","/externalEvents/*","/layouts/*","/eventsFunctionsExtensions/*"])),isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT"});return Promise.all(o.map((function(e){return j(e.object,h.join(n,e.reference)+".json").catch((function(e){throw console.error("Unable to write a partial file:",e),e}))}))).then((function(){return j(r,t).catch((function(e){throw console.error("Unable to write the split project:",e),e}))}))}return j(r,t).catch((function(e){throw console.error("Unable to write the project:",e),e}))},P=function(e,t){var n=t.fileIdentifier;if(!n)return Promise.reject('Project file is empty, "Save as" should have been called?');var r=h.dirname(n);return x(e,n,r).then((function(){return{wasSaved:!0,fileMetadata:t}}))},O=function(e,t){var n=t?t.fileIdentifier:"",o=f()(new m.AbstractFileSystemJS,p.a),a=g.remote.getCurrentWindow(),i={defaultPath:n,filters:[{name:"GDevelop 5 project",extensions:["json"]}]};if(!b)return Promise.reject("Unsupported");var u=b.showSaveDialogSync(a,i);if(!u)return Promise.resolve({wasSaved:!1,fileMetadata:t});var c=h.dirname(u);return m.ProjectResourcesCopier.copyAllResourcesTo(e,o,c,!0,!1,!0),e.setProjectFile(u),x(e,u,c).then((function(){return{wasSaved:!0,fileMetadata:Object(r.a)(Object(r.a)({},t),{},{fileIdentifier:u})}}))},S=function(e,t){var n=t.fileIdentifier+".autosave";return E(Object(u.a)(e),n).catch((function(e){throw console.error("Unable to write ".concat(n,":"),e),e}))}}).call(this,n(8))},927:function(e,t,n){"use strict";var r=n(119),o=n(17),a=n.n(o),i=n(903),u=a()("fs"),c=a()("path"),s=a()("electron"),l=s?s.remote.dialog:null,p=function(e){return u?new Promise((function(t,n){u.readFile(e,{encoding:"utf8"},(function(r,o){if(r)return n(r);try{var a=JSON.parse(o);return t(a)}catch(i){return n(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")},d=function(){if(!l)return Promise.reject("Not supported");var e=s.remote.getCurrentWindow();return l.showOpenDialog(e,{title:"Open a project",properties:["openFile"],message:"If you want to open your GDevelop 4 project, be sure to save it as a .json file",filters:[{name:"GDevelop 5 project",extensions:["json"]}]}).then((function(e){var t=e.filePaths;return t&&t.length?{fileIdentifier:t[0]}:null}))},f=function(e){var t=e.fileIdentifier,n=c.dirname(t);return p(t).then((function(e){return Object(i.d)(e,{getReferencePartialObject:function(e){return p(c.join(n,e)+".json")},isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT",maxUnsplitDepth:3}).then((function(){return{content:e}}))}))},m=function(e,t){var n=e.fileIdentifier,r=n+".autosave";if(u.existsSync(r)){if(!t)return Promise.resolve(!0);try{if(u.statSync(r).mtime.getTime()>u.statSync(n).mtime.getTime())return Promise.resolve(!0)}catch(o){return console.error("Unable to compare *.autosave to project",o),Promise.resolve(!1)}return Promise.resolve(!1)}return Promise.resolve(!1)},v=function(e){return Promise.resolve(Object(r.a)(Object(r.a)({},e),{},{fileIdentifier:e.fileIdentifier+".autosave"}))},h=n(904),g=n(16);t.a={internalName:"LocalFile",name:{id:"Local file system"},getFileMetadataFromAppArguments:function(e){return e[g.a]&&e[g.a].length?{fileIdentifier:e[g.a][0]}:null},createOperations:function(){return{onOpenWithPicker:d,onOpen:f,hasAutoSave:m,onSaveProject:h.b,onSaveProjectAs:h.c,onAutoSaveProject:h.a,onGetAutoSave:v,getOpenErrorMessage:function(e){return{id:"Check that the file exists, that this file is a proper game created with GDevelop and that you have the authorizations to open it."}}}}}}}]);
//# sourceMappingURL=local-app.7f74f72f.chunk.js.map